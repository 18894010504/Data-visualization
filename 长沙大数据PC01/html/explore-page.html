<Affix id="sub_header" class="sub-header-affix">
    <div class="sub-header">
        <i-select class="subject-title-select" v-model="subjectSelectValue">
            <i-option value="New York" label="New York">
                <span>New York</span>
                <span style="float:right;color:#ccc">America</span>
            </i-option>
            <i-option value="London" label="London">
                <span>London</span>
                <span style="float:right;color:#ccc">U.K.</span>
            </i-option>
            <i-option value="Sydney" label="Sydney">
                <span>Sydney</span>
                <span style="float:right;color:#ccc">Australian</span>
            </i-option>
        </i-select>
        <div class="date-picker-box">
            <date-picker type="daterange" format="yyyy/MM/dd" :editable="false" :clearable="false" :options="datePickerOptions" placement="bottom-end" placeholder="选择日期" :value="datePickerValue" @on-open-change="datePickerToggle"></date-picker>
            <Icon class="arrow" type="chevron-down"></Icon>
        </div>
        <div class="filter-conditions">
            <span class="funnel" @click="filterConditionsListToggle">
                <Icon type="funnel"></Icon>
            </span>
            <div class="filter-content" @click="filterConditionsListToggle">
                <template v-if="selectedFilterConditions.length > 0" v-for="item in selectedFilterConditions">
                    <span v-text="item"></span>
                </template>
                <template v-if="selectedFilterConditions.length == 0">
                    <span>过滤</span>
                </template>
            </div>
            <i-button type="text" icon="ios-close-outline" v-if="selectedFilterConditions.length > 0" @click="clearAllFilterConditions">清空</i-button>
            <span class="arrow" @click="filterConditionsListToggle">
                <Icon v-if="filterConditionsListOpen" type="chevron-up"></Icon>
                <Icon v-else type="chevron-down"></Icon>
            </span>
        </div>
        <div :class="filterConditionsListOpen ? 'filter-conditions-list' : 'filter-conditions-list hide'">
            <div class="conditions-box" v-for="(data, index) in filterList">
                <span class="label" v-text="'选择' + data.title"></span>
                <i-select v-model="data.value" filterable multiple>
                    <i-option v-for="item in data.list" :value="item.value" :key="item.value" v-text="item.label"></i-option>
                </i-select>
                <span class="clear" v-if="data.value.length > 0" @click="clearFilterConditions(index)">
                    <Icon type="close-round"></Icon>
                </span>
            </div>
            <div class="conditions-confirm">
                <i-button type="primary" @click="confirmFilterConditions">确认</i-button>
                <i-button @click="cancelFilterConditions">取消</i-button>
            </div>
        </div>
    </div>
</Affix>
<div class="page-container">
    <div class="inner-page">
        <div id="inner_page_header"></div>
        <div id="explore_addmetric">
            <div class="explore-addmetric-panel">
                <i-button type="info" size="large">查询数据</i-button>
                <Row class="addmetric-box">
                    <i-col span="8">
                        <span class="label">指标</span>
                        <div class="cont-box" @click="metricOpen1 = true">
                            <Icon type="ios-plus-outline"></Icon>
                            <span>添加指标</span>
                        </div>
                    </i-col>
                    <i-col span="8">
                        <span class="label">指标</span>
                        <div class="cont-box" @click="metricOpen1 = true">
                            <Icon type="ios-plus-outline"></Icon>
                            <span>添加指标</span>
                        </div>
                    </i-col>
                    <i-col span="8">
                        <span class="label">维度</span>
                        <div class="cont-box" @click="metricOpen2 = true">
                            <Icon type="ios-plus-outline"></Icon>
                            <span>添加维度</span>
                        </div>
                    </i-col>
                </Row>
                <Modal class="metric-modal" v-model="metricOpen1" title="选择指标">
                    <Tabs :animated="false">
                        <tab-pane label="指标分类1">
                            <div class="equ-title">
                                <i-input class="search" size="small" icon="ios-search" placeholder="搜索"></i-input>
                                <Breadcrumb>
                                    <breadcrumb-item href="javascript:void(0);">指标</breadcrumb-item>
                                    <breadcrumb-item>指标指标</breadcrumb-item>
                                </Breadcrumb>
                            </div>
                            <ul class="equ-metric">
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li class="active">
                                    <Icon class="hide" type="chevron-right"></Icon>
                                    <Icon type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                            </ul>
                        </tab-pane>
                        <tab-pane label="指标分类2">
                            <div class="equ-title">
                                <i-input class="search" size="small" icon="ios-search" placeholder="搜索"></i-input>
                                <Breadcrumb>
                                    <breadcrumb-item href="javascript:void(0);">指标</breadcrumb-item>
                                    <breadcrumb-item>指标指标</breadcrumb-item>
                                </Breadcrumb>
                            </div>
                            <ul class="equ-metric">
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li class="active">
                                    <Icon class="hide" type="chevron-right"></Icon>
                                    <Icon type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                            </ul>
                        </tab-pane>
                        <tab-pane label="指标分类3">
                            <div class="equ-title">
                                <i-input class="search" size="small" icon="ios-search" placeholder="搜索"></i-input>
                                <Breadcrumb>
                                    <breadcrumb-item href="javascript:void(0);">指标</breadcrumb-item>
                                    <breadcrumb-item>指标指标</breadcrumb-item>
                                </Breadcrumb>
                            </div>
                            <ul class="equ-metric">
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li class="active">
                                    <Icon class="hide" type="chevron-right"></Icon>
                                    <Icon type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                                <li>
                                    <Icon type="chevron-right"></Icon>
                                    <Icon class="hide" type="checkmark-round"></Icon>
                                    <span>指标指标指标指标</span>
                                </li>
                            </ul>
                        </tab-pane>
                    </Tabs>
                </Modal>
                <Modal class="metric-modal" v-model="metricOpen2" title="选择纬度">
                    <ul class="equ-metric">
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li class="active">
                            <Icon type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                        <li>
                            <Icon class="hide" type="checkmark-round"></Icon>
                            <span>纬度纬度纬度纬度</span>
                        </li>
                    </ul>
                </Modal>
            </div>
        </div>
        <div id="chart_table_panel"></div>
        <div id="inner_page_footer"></div>
    </div>
    <div id="page_footer"></div>
</div>
<script type="text/javascript">
new Vue({
    el: '#sub_header',
    data: {
        subjectSelectValue: '',
        datePickerValue: ['2016-01-01', '2016-02-15'],
        datePickerOptions: {
            shortcuts: [{
                text: '今日',
                value() {
                    const end = new Date();
                    const start = new Date();
                    return [start, end];
                }
            }, {
                text: '昨日',
                value() {
                    const end = new Date();
                    const start = new Date();
                    start.setTime(start.getTime() - 3600 * 1000 * 24);
                    end.setTime(end.getTime() - 3600 * 1000 * 24);
                    return [start, end];
                }
            }, {
                text: '最近一周',
                value() {
                    const end = new Date();
                    const start = new Date();
                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);
                    return [start, end];
                }
            }, {
                text: '最近一个月',
                value() {
                    const end = new Date();
                    const start = new Date();
                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);
                    return [start, end];
                }
            }, {
                text: '最近三个月',
                value() {
                    const end = new Date();
                    const start = new Date();
                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);
                    return [start, end];
                }
            }]
        },
        filterList: [{
            title: '条件1',
            value: [],
            list: [{
                value: 'value11',
                label: '条件11'
            }, {
                value: 'value12',
                label: '条件12'
            }, {
                value: 'value13',
                label: '条件13'
            }, {
                value: 'value14',
                label: '条件14'
            }, {
                value: 'value15',
                label: '条件15'
            }, {
                value: 'value16',
                label: '条件16'
            }]
        }, {
            title: '条件2',
            value: [],
            list: [{
                value: 'value21',
                label: '条件21'
            }, {
                value: 'value22',
                label: '条件22'
            }, {
                value: 'value23',
                label: '条件23'
            }, {
                value: 'value24',
                label: '条件24'
            }, {
                value: 'value25',
                label: '条件25'
            }, {
                value: 'value26',
                label: '条件26'
            }]
        }, {
            title: '条件3',
            value: [],
            list: [{
                value: 'value31',
                label: '条件31'
            }, {
                value: 'value32',
                label: '条件32'
            }, {
                value: 'value33',
                label: '条件33'
            }, {
                value: 'value34',
                label: '条件34'
            }, {
                value: 'value35',
                label: '条件35'
            }, {
                value: 'value36',
                label: '条件36'
            }]
        }],
        selectedFilterConditions: [],
        filterValueList: [],
        filterConditionsListOpen: false
    },
    created: function() {

    },
    mounted: function() {
        this.setFilterValueList();

        $('.sub-header .filter-conditions .funnel, .sub-header .filter-conditions .filter-content, .sub-header .filter-conditions .arrow').hover(function() {
            $(this).parents('.filter-conditions').addClass('hover');
        }, function() {
            $(this).parents('.filter-conditions').removeClass('hover');
        });
    },
    methods: {
        setFilterValueList: function() {
            for (var i = 0; i < this.filterList.length; i++) {
                this.filterValueList[i] = [];
                for (var j = 0; j < this.filterList[i].value.length; j++) {
                    this.filterValueList[i][j] = this.filterList[i].value[j];
                }
            }
        },
        datePickerToggle: function(state) {
            if (state) {
                $('.sub-header .date-picker-box .arrow').removeClass('ivu-icon-chevron-down').addClass('ivu-icon-chevron-up');
            } else {
                $('.sub-header .date-picker-box .arrow').removeClass('ivu-icon-chevron-up').addClass('ivu-icon-chevron-down');
            }
        },
        filterConditionsListToggle: function() {
            if (this.filterConditionsListOpen) {
                this.cancelFilterConditions();
            } else {
                this.filterConditionsListOpen = true;
            }
        },
        clearFilterConditions: function(index) {
            this.filterList[index].value = [];
        },
        clearAllFilterConditions: function() {
            for (var i = 0; i < this.filterList.length; i++) {
                this.filterList[i].value = [];
            }

            this.confirmFilterConditions();
        },
        cancelFilterConditions: function() {
            for (var i = 0; i < this.filterValueList.length; i++) {
                this.filterList[i].value = [];
                for (var j = 0; j < this.filterValueList[i].length; j++) {
                    this.filterList[i].value[j] = this.filterValueList[i][j];
                }
            }
            this.filterConditionsListOpen = false;
        },
        confirmFilterConditions: function() {
            var list = this.filterList;
            var array = [];
            var term = true;
            for (var i = 0; i < list.length; i++) {
                if (list[i].value.length == 0) {
                    array.push(list[i].title + ' all；');
                } else {
                    array.push(list[i].title + ' ' + list[i].value.length + '；');
                    term = false;
                }
            }
            array[array.length - 1] = array[array.length - 1].substring(0, array[array.length - 1].length - 1);
            if (term) {
                array = [];
            }
            this.selectedFilterConditions = array;

            this.setFilterValueList();
            this.filterConditionsListOpen = false;
        }
    }
});

new Vue({
    el: '#explore_addmetric',
    data: {
        metricOpen1: false,
        metricOpen2: false
    },
    created: function() {

    },
    mounted: function() {

    },
    methods: {

    }
});

$('#inner_page_header').tourInnerPageHeader({
    pageTitle: '数据观象',
    select: true,
    breadCrumb: false,
    btnAddOftenUse: false,
    btnPhoneView: false,
    btnPrintReport: false
});

$('#chart_table_panel').tourChartTablePanel({
    chartId: 'chart_id',
    info: false,
    chartLegend: '游客人数',
    chartType: 'line',
    columns: [{
        "title": "名称",
        "key": "name",
        "fixed": "left",
        "width": 200
    }, {
        "title": "展示",
        "key": "show",
        "width": 150,
        "sortable": true,
        className: '',
        filters: [{
            label: '大于4000',
            value: 1
        }, {
            label: '小于4000',
            value: 2
        }],
        filterMultiple: false,
        filterMethod(value, row) {
            if (value === 1) {
                return row.show > 4000;
            } else if (value === 2) {
                return row.show < 4000;
            }
        }
    }, {
        "title": "唤醒",
        "key": "weak",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "登录",
        "key": "signin",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "点击",
        "key": "click",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "激活",
        "key": "active",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "7日留存",
        "key": "day7",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "30日留存",
        "key": "day30",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "次日留存",
        "key": "tomorrow",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "日活跃",
        "key": "day",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "周活跃",
        "key": "week",
        "width": 150,
        "sortable": true,
        className: ''
    }, {
        "title": "月活跃",
        "key": "month",
        "width": 150,
        "sortable": true,
        className: ''
    }],
    data: [{
        "name": "推广名称1",
        "fav": 0,
        "show": 7302,
        "weak": 5627,
        "signin": 1563,
        "click": 4254,
        "active": 1438,
        "day7": 274,
        "day30": 285,
        "tomorrow": 1727,
        "day": 558,
        "week": 4440,
        "month": 5610
    }, {
        "name": "推广名称2",
        "fav": 0,
        "show": 4720,
        "weak": 4086,
        "signin": 3792,
        "click": 8690,
        "active": 8470,
        "day7": 8172,
        "day30": 5197,
        "tomorrow": 1684,
        "day": 2593,
        "week": 2507,
        "month": 1537
    }, {
        "name": "推广名称3",
        "fav": 0,
        "show": 7181,
        "weak": 8007,
        "signin": 8477,
        "click": 1879,
        "active": 16,
        "day7": 2249,
        "day30": 3450,
        "tomorrow": 377,
        "day": 1561,
        "week": 3219,
        "month": 1588
    }, {
        "name": "推广名称4",
        "fav": 0,
        "show": 9911,
        "weak": 8976,
        "signin": 8807,
        "click": 8050,
        "active": 7668,
        "day7": 1547,
        "day30": 2357,
        "tomorrow": 7278,
        "day": 5309,
        "week": 1655,
        "month": 9043
    }, {
        "name": "推广名称5",
        "fav": 0,
        "show": 934,
        "weak": 1394,
        "signin": 6463,
        "click": 5278,
        "active": 9256,
        "day7": 209,
        "day30": 3563,
        "tomorrow": 8285,
        "day": 1230,
        "week": 4840,
        "month": 9908
    }, {
        "name": "推广名称6",
        "fav": 0,
        "show": 6856,
        "weak": 1608,
        "signin": 457,
        "click": 4949,
        "active": 2909,
        "day7": 4525,
        "day30": 6171,
        "tomorrow": 1920,
        "day": 1966,
        "week": 904,
        "month": 6851
    }, {
        "name": "推广名称7",
        "fav": 0,
        "show": 5107,
        "weak": 6407,
        "signin": 4166,
        "click": 7970,
        "active": 1002,
        "day7": 8701,
        "day30": 9040,
        "tomorrow": 7632,
        "day": 4061,
        "week": 4359,
        "month": 3676
    }, {
        "name": "推广名称8",
        "fav": 0,
        "show": 862,
        "weak": 6520,
        "signin": 6696,
        "click": 3209,
        "active": 6801,
        "day7": 6364,
        "day30": 6850,
        "tomorrow": 9408,
        "day": 2481,
        "week": 1479,
        "month": 2346
    }, {
        "name": "推广名称9",
        "fav": 0,
        "show": 567,
        "weak": 5859,
        "signin": 128,
        "click": 6593,
        "active": 1971,
        "day7": 7596,
        "day30": 3546,
        "tomorrow": 6641,
        "day": 1611,
        "week": 5534,
        "month": 3190
    }, {
        "name": "推广名称10",
        "fav": 0,
        "show": 3651,
        "weak": 1819,
        "signin": 4595,
        "click": 7499,
        "active": 7405,
        "day7": 8710,
        "day30": 5518,
        "tomorrow": 428,
        "day": 9768,
        "week": 2864,
        "month": 5811
    }]
});

$('#inner_page_footer').tourInnerPageFooter({
    source: '万维旅游云服务 ©wanwei.com.cn',
    content: `<p>这里显示有关这个专题数据分析的解释内容，包括词汇解释，计算模型的描述等；</p>
            <p>这里显示有关这个专题数据分析的解释内容，包括词汇解释，计算模型的描述等；</p>
            <p>这里显示有关这个专题数据分析的解释内容，包括词汇解释，计算模型的描述等；</p>
            <p>这里显示有关这个专题数据分析的解释内容，包括词汇解释，计算模型的描述等。</p>`
});

$('#page_footer').tourFooter();
</script>